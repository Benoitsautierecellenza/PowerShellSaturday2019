
$ResourceGroupName = "testkeyvault"
$StorageAccountName = "st0" + -join ((97..122) | Get-Random -Count 13 | % {[char]$_})
[Array]$parameters = @("172.16.0.0/16", "192.168.0.0/16", "10.0.0.0/8")
New-AzStorageAccount -ResourceGroupName $ResourceGroupName -AccountName $StorageAccountName -Location westeurope -SkuName Standard_LRS -Kind StorageV2 -AccessTier Hot

. .\AFW-StorageAccount.ps1 -ResourceName $StorageAccountName -ServiceType "Storage" -OperationName "Create" -SourceAddress $Parameters

#
# Déclencher la création d'un Storage Account
#
$ResourceGroupName = "testkeyvault"
$StorageAccountName = "st0" + -join ((97..122) | Get-Random -Count 13 | % {[char]$_})
New-AzStorageAccount -ResourceGroupName $ResourceGroupName -AccountName $StorageAccountName -Location westeurope -SkuName Standard_LRS -Kind StorageV2 -AccessTier Hot
#
# Constater le Job pour Handle-Alert
# Lister les jobs
Get-AzAutomationJob -ResourceGroupname LabAutomation -AutomationAccount LabAutomation -RunbookName Handle-Alert -Status Queued

 | select -first 2

. .\AFW-ProcessServiceRules.PS1 -ResourceName $StorageAccountName -ServiceType "Storage" -OperationName "Create" 